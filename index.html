<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>SOAP分割テスト</title>
</head>
<body>

    <!-- 右上に固定するリロードボタン -->
    <button id="reloadBtn" onclick="location.reload()">🗑️</button>

    <style>
        #reloadBtn {
            position: fixed;
            top: 10px;
            right: 40%;
            padding: 8px 12px;
            font-size: 20px;
            border: none;
            background: #eee;
            cursor: pointer;
            border-radius: 6px;
        }

        #reloadBtn:hover {
            background: #ddd;
        }
    </style>
    <h1>文章分割とコピー</h1>

    <p>元の文章（【S】【O】【A】【EP】【OP】を含む全文）を貼り付けてください。</p>
    <textarea id="sourceText" rows="15" cols="80"></textarea>
    <br>
    <button type="button" onclick="splitText()">5ブロックに分割する</button>

    <hr>

    <h2>S</h2>
    <textarea id="sBlock" rows="5" cols="80"></textarea>
    <br>
    <button type="button" onclick="copyBlock('sBlock', this)">Sをコピー</button>

    <h2>O</h2>
    <textarea id="oBlock" rows="5" cols="80"></textarea>
    <br>
    <button type="button" onclick="copyBlock('oBlock', this)">Oをコピー</button>

    <h2>A</h2>
    <textarea id="aBlock" rows="5" cols="80"></textarea>
    <br>
    <button type="button" onclick="copyBlock('aBlock', this)">Aをコピー</button>

    <h2>EP</h2>
    <textarea id="epBlock" rows="5" cols="80"></textarea>
    <br>
    <button type="button" onclick="copyBlock('epBlock', this)">EPをコピー</button>

    <h2>OP</h2>
    <textarea id="opBlock" rows="5" cols="80"></textarea>
    <br>
    <button type="button" onclick="copyBlock('opBlock', this)">OPをコピー</button>

        <script>
        function splitText() {
            const text = document.getElementById("sourceText").value;

            const pattern = /【S】([\s\S]*?)【O】([\s\S]*?)【A】([\s\S]*?)【EP】([\s\S]*?)【OP】([\s\S]*)/;
            const match = text.match(pattern);

            if (!match) {
                alert("【S】【O】【A】【EP】【OP】の形式で文章が見つかりません。");
                return;
            }

            // 見出しを残して出力
            document.getElementById("sBlock").value  = "【S】\n"  + match[1].trim();
            document.getElementById("oBlock").value  = "【O】\n"  + match[2].trim();
            document.getElementById("aBlock").value  = "【A】\n"  + match[3].trim();
            document.getElementById("epBlock").value = "【EP】\n" + match[4].trim();
            document.getElementById("opBlock").value = "【OP】\n" + match[5].trim();
        }

        function copyBlock(id, btn) {
            const area = document.getElementById(id);
            const text = area.value;

            if (!text) {
                alert("コピーする内容がありません。");
                return;
            }

            navigator.clipboard.writeText(text)
                .then(() => {
                    // ボタン色変更
                    btn.style.backgroundColor = "#8bc34a";  // 緑
                    btn.style.color = "white";

                    // 1秒後に戻す
                    setTimeout(() => {
                        btn.style.backgroundColor = "";
                        btn.style.color = "";
                    }, 1000);
                })
                .catch(err => {
                    alert("コピーに失敗しました。");
                    console.error(err);
                });
        }

    </script>

</body>
<footer><p>株式会社かなうま</p></footer>
</html>
